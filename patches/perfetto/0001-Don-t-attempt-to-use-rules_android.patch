From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Felix Hanau <felix@cloudflare.com>
Date: Sat, 15 Nov 2025 16:55:07 -0500
Subject: Don't attempt to use rules_android


diff --git a/MODULE.bazel b/MODULE.bazel
index a321128ae62530e160b6d2ef7c99a98f7071396d..237cac531da071da049eaa3c35c84be7fbcc5a9f 100644
--- a/MODULE.bazel
+++ b/MODULE.bazel
@@ -12,35 +12,7 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-bazel_dep(name = "rules_android", version = "0.6.0")
-
-android_sdk_repository_extension = use_extension(
-    "@rules_android//rules/android_sdk_repository:rule.bzl",
-    "android_sdk_repository_extension",
-)
-
-# When built using 'tools/bazel', 'ANDROID_HOME' environment variable points
-# to the hermetic Android SDK installation, that should be downloaded first
-# with 'tools/install-build-deps --android'
-android_sdk_repository_extension.configure(
-    api_level = 35,
-    build_tools_version = "35.0.1",
-)
-
-bazel_dep(name = "rules_jvm_external", version = "6.6")
-bazel_dep(name = "rules_android_ndk", version = "0.1.2")
-
-android_ndk_repository_extension = use_extension(
-    "@rules_android_ndk//:extension.bzl",
-    "android_ndk_repository_extension",
-)
-
-# When built using 'tools/bazel', 'ANDROID_NDK_HOME' environment variable points
-# to the hermetic Android NDK installation, that should be downloaded first
-# with 'tools/install-build-deps --android'
-android_ndk_repository_extension.configure(
-    api_level = 26,
-)
-use_repo(android_ndk_repository_extension, "androidndk")
-
-register_toolchains("@androidndk//:all")
+module(name = "perfetto")
+bazel_dep(name = "perfetto_cfg", version = "0.0.0")
+bazel_dep(name = "platforms", version = "1.0.0")
+bazel_dep(name = "protobuf", version = "33.1")
diff --git a/bazel/rules.bzl b/bazel/rules.bzl
index 563382a18bfde2506f613f274304387dace9f2dd..d7e77cf21416588a3a55e0bb6d67099a148d1de1 100644
--- a/bazel/rules.bzl
+++ b/bazel/rules.bzl
@@ -13,9 +13,7 @@
 # limitations under the License.
 
 load("@perfetto//bazel:proto_gen.bzl", "proto_descriptor_gen", "proto_gen")
-load("@perfetto//bazel:run_ait_with_adb.bzl", "android_instrumentation_test")
 load("@perfetto_cfg//:perfetto_cfg.bzl", "PERFETTO_CONFIG")
-load("@rules_android//android:rules.bzl", "android_binary", "android_library")
 
 # +----------------------------------------------------------------------------+
 # | Base C++ rules.                                                            |
@@ -112,12 +110,10 @@ def perfetto_jspb_proto_library(**kwargs):
 # | Android-related rules                                                      |
 # +----------------------------------------------------------------------------+
 def perfetto_android_binary(**kwargs):
-    if not _rule_override("android_binary", **kwargs):
-        android_binary(**kwargs)
+    pass
 
 def perfetto_android_library(**kwargs):
-    if not _rule_override("android_library", **kwargs):
-        android_library(**kwargs)
+    pass
 
 def perfetto_android_jni_library(**kwargs):
     if not _rule_override("android_jni_library", **kwargs):
@@ -170,8 +166,7 @@ def _perfetto_android_jni_library(
     )
 
 def perfetto_android_instrumentation_test(**kwargs):
-    if not _rule_override("android_instrumentation_test", **kwargs):
-        android_instrumentation_test(**kwargs)
+    pass
 
 # +----------------------------------------------------------------------------+
 # | Misc rules.                                                                |
