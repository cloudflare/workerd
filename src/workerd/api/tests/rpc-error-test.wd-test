using Workerd = import "/workerd/workerd.capnp";

const unitTests :Workerd.Config = (
  services = [
    (name = "TEST_TMPDIR", disk = (writable = true)),
    ( name = "rpc-error-test",
      worker = (
        modules = [
          (name = "worker", esModule = embed "rpc-error-test.js")
        ],
        compatibilityDate = "2025-08-10",
        compatibilityFlags = ["nodejs_compat", "experimental"],
        bindings = [
          (name = "Foo", durableObjectNamespace = "Foo"),
          (name = "Bar", durableObjectNamespace=(serviceName="rpc-target", className="Bar")),
        ],
        durableObjectNamespaces = [
          (className = "Foo", uniqueKey = "foo"),
        ],

        durableObjectStorage = (localDisk = "TEST_TMPDIR"),
      ),

    ),
    ( name = "rpc-target",
      worker = (
        modules = [
          (name = "worker", esModule = embed "rpc-error-test.rpc.js")
        ],
        compatibilityFlags = ["nodejs_compat", "experimental"],
        compatibilityDate = "2025-08-10",
        durableObjectNamespaces = [
          (className = "Bar", uniqueKey = "bar")
        ],

        durableObjectStorage = (localDisk = "TEST_TMPDIR"),
      ),
    ),
  ],
);
